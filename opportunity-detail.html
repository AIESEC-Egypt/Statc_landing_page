<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-T4PJSH2');</script>
        <!-- End Google Tag Manager -->
            <meta charset="UTF-8">
            <title>Opp-Detail | AIESEC in EGYPT</title>
            <meta name="description" content="AIESEC develops the next generation of young leaders with impactful professional and volunteering experiences to activate their leadership potential.">
            <meta name="keywords" content="volunteer, world, impact, creative, inspiration, youth">
            <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta property="og:locale" content="en_US">
        <meta property="og:type" content="website">
        <meta property="og:title" content="AIESEC EGYPT">
        <meta property="og:description" content="AIESEC is the biggest youth run organization that aims to develop leadership potential through cross cultural exchange and practical experience.">
        <meta property="og:url" content="https://aiesec.org.eg/">
        <meta property="og:site_name" content="AIESEC in EGYPT">
        <meta property="article:publisher" content="https://www.facebook.com/aiesecegypt">
        <meta property="og:image" content="img/fb.jpg">
        
        <!-- Icons -->
            <link rel="apple-touch-icon-precomposed" href="img/icons/apple-touch-icon.png">
            <link rel="icon" href="img/logos/AIESEC-Favicon-309x341.png">
        
        <!-- Stylesheets -->
            <link rel="stylesheet" href="css/fontawesome.min.css">
        <!-- <link rel="stylesheet" href="css/main.min.css"> -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
		<link href="https://fonts.googleapis.com/css?family=Heebo|Roboto&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    
        <!-- JavaScript -->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
		<script src="https://use.fontawesome.com/7bcb44edef.js"></script>
    </head>
    
    <body>

		<style>
			body {
				font-family: 'Montserrat', 'Roboto';
			}

			nav {
				background-color: #51585E;
			}

			.do-not-display {
				display: none;
			}

			.img-container {
				overflow: hidden; 
				max-height: 500px;
				border: solid 3px #555555;
        		border-radius: 15px;
				box-shadow: 2px 3px 10px 5px rgba(44, 58, 70, 0.5);
			}

			#opportunity-cover-img {
				width: 100%;
			}

			#apply-opportunity-sticky-card {
				width: 90%; 
				position: sticky; 
				top: 10%;
				background-color: #7E9CB3;
			}

			.btn-custom {
				box-shadow: 3px 5px 10px 5px rgba(44, 58, 70, 0.5);
			}

			.custom-card {
				box-shadow: 2px 3px 10px 5px rgba(44, 58, 70, 0.5);
			}

		</style>

        <!-- Navbar Starts -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <img src="./img/logos/header-light.png" height="30" alt="" loading="lazy" class="pl-4">
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Link</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Dropdown
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="#">Action</a>
                            <a class="dropdown-item" href="#">Another action</a>
                                <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">Something else here</a>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
                    </li>
                </ul>
                <ul class="navbar-nav mr-0">
                    <li class="nav-item active user-details">
                    </li>
                    <li class="nav-item active login-status">
                    </li>
                </ul>
            </div>
        </nav>
        <!-- Navbar Ends -->

		<!-- Content Starts -->
        <div class="container-fluid content-container do-not-display">
		  <br>
		  <div class="img-container">
			<img src="" alt="Opportunity-Image" class="img-fluids" id="opportunity-cover-img">
		  </div>
          <div class="container-fluid mt-5">
			  <div class="container-fluid">
				<div class="row">
					<div class="col-lg-7">
						<h1 id="opportunity-title"></h1>
						<h5 class="font-weight-light" id="opportunity-company-and-location"></h5>
						<p style="cursor: pointer;">
							<span onclick="share('facebook');"><i class="fa fa-facebook text-muted"></i></span>&nbsp;&nbsp;
							<span onclick="share('twitter');"><i class="fa fa-twitter text-muted"></i></span>&nbsp;&nbsp;
							<span onclick="share('linkedin');"><i class="fa fa-linkedin text-muted"></i></span>
						</p>
						<hr>
						<br>

						<h2>Company</h2>
						<br>
						<p class="font-weight-bold" id="opportunity-company"></p>
						<p id="opportunity-company-summary"></p>
						
						<br><hr><br>

						<h2>Role</h2>
						<br>
						<p class="font-weight-bold">Description</p>
						<p id="opportunity-description"></p>
						<br>
						<p class="font-weight-bold">Working Hours</p>
						<ul id="opportunity-work-hours"></ul>
						<br>
						<p class="font-weight-bold">Responsibilities</p>
						<div id="opportunity-responsibilities"></div>

						<br><hr><br>

						<h2>Slots</h2>
						<ul id="opportunity-slots"></ul>

						<br><hr><br>

						<h2>Eligibility</h2>
						<br>
						<div class="row">
							<div class="col-lg-4 mb-3 font-weight-bold">Backgrounds</div>
							<div class="col-lg-8">
								<h5 id="opportunity-backgrounds"></h5>
							</div>
						</div>
						<hr>
						<div class="row">
							<div class="col-lg-4 mb-3 font-weight-bold">Skills</div>
							<div class="col-lg-8">
								<h5 id="opportunity-skills"></h5>
							</div>
						</div>
						<hr>
						<div class="row">
							<div class="col-lg-4 mb-3 font-weight-bold">Languages</div>
							<div class="col-lg-8">
								<h5 id="opportunity-languages"></h5>
							</div>
						</div>
						<hr>
						<div class="row">
							<div class="col-lg-4 mb-3 font-weight-bold">Nationality</div>
							<div class="col-lg-8">
								<h5 id="opportunity-nationalities"></h5>
							</div>
						</div>
						<hr>
						<div class="row">
							<div class="col-lg-4 mb-3 font-weight-bold">Minimum Study Level</div>
							<div class="col-lg-8">
								<h5 id="opportunity-study-levels"></h5>
							</div>
						</div>

						<br><hr><br>

						<h2>Logistics</h2>
						<br>
						<div id="opportunity-logistical-details"></div>

						<br><hr><br>
					  
					</div>
					<div class="col-lg-1"></div>
					<div class="col-lg-4">
						<div class="card custom-card" id="apply-opportunity-sticky-card">
							<div class="card-body">
								<h5 class="card-title font-weight-bold" id="opportunity-fees"></h5>
								<br>
								<h6 class="card-subtitle mb-2 text-white">Pick the slot suitable for you</h6>
								<select class="form-control" id="opportunity-select-slot"></select>
								<br>
								<button class="btn btn-dark btn-custom btn-block">Apply Now</button>
							</div>
						</div>
					</div>
				  </div>
			  </div>
          </div>
		</div>
		<br><br><br>
		<!-- Content Ends -->

		<!-- Spinner Starts -->
		<div class="spinner-container">
			<div class="d-flex justify-content-center">
			  <div class="spinner-border" role="status">
				<span class="sr-only">Loading...</span>
			  </div>
			</div>
		</div>
		<!-- Spinner Ends -->

        <script>

            function get_opportunity_id(){
                var current_url = document.location.href;
                var params = current_url.split('?')[1].split('&');
                var data = {}, tmp;
                for (var i = 0, l = params.length; i < l; i++) {
                    tmp = params[i].split('=');
                    data[tmp[0]] = tmp[1];
                }
                if(data.id){
                    return data.id;
                }
                else {
                    /* RETURN 404 */
                }
            }

            function render_opportunity(data) {
				$('#opportunity-cover-img').attr("src", data['data']['getOpportunity']['cover_photo'].url);
				$('#opportunity-title').html(data['data']['getOpportunity']['title']);
				$('#opportunity-company-and-location').html(`${data['data']['getOpportunity']['organisation']['name']} &#8226; ${data['data']['getOpportunity']['location']}`);
				$('#opportunity-company').html(`About ${data['data']['getOpportunity']['organisation']['name']}`);
				$('#opportunity-company-summary').html(data['data']['getOpportunity']['organisation']['summary']);
				$('#opportunity-description').html(data['data']['getOpportunity']['description']);

				var work_hours = data['data']['getOpportunity']['work_hours'];
				var work_hours_str = '';
				for(var i = 0; i < work_hours.length; i++) {
					work_hours_str = work_hours_str + "<li>" + work_hours[i]["name"] + ": <span class=\"font-weight-light\">" + work_hours[i]["from"] + " to " + work_hours[i]["to"] + "</span></li>";
				}
				$('#opportunity-work-hours').html(work_hours_str);
				$('#opportunity-responsibilities').html(data['data']['getOpportunity']['role_info']['learning_points_list']);
				
				$('#opportunity-slots').empty();
				var available_slots = data['data']['getOpportunity']['available_slots'];
				for(var i = 0; i < available_slots.length; i++) {
					$('#opportunity-slots').append(`<li> From ${available_slots[i]['start_date']} to ${available_slots[i]['end_date']} </li>`);
				}

				$('#opportunity-backgrounds').empty();
				var backgrounds = data['data']['getOpportunity']['backgrounds'];
				for(var i = 0; i < backgrounds.length; i++) {
					$('#opportunity-backgrounds').append(`<span class="badge badge-pill badge-light font-weight-normal">${backgrounds[i]['constant_name']}</span>`);
				}

				$('#opportunity-skills').empty();
				var skills = data['data']['getOpportunity']['skills'];
				for(var i = 0; i < skills.length; i++) {
					$('#opportunity-skills').append(`<span class="badge badge-pill badge-light font-weight-normal">${skills[i]['constant_name']}</span>`);
				}

				$('#opportunity-languages').empty();
				var languages = data['data']['getOpportunity']['languages'];
				for(var i = 0; i < languages.length; i++) {
					$('#opportunity-languages').append(`<span class="badge badge-pill badge-light font-weight-normal">${languages[i]['constant_name']}</span>`);
				}

				$('#opportunity-nationalities').empty();
				var nationalities = data['data']['getOpportunity']['nationalities'];
				if(nationalities.length > 0) {
					for(var i = 0; i < nationalities.length; i++) {
						$('#opportunity-nationalities').append(`<span class="badge badge-pill badge-light font-weight-normal">${nationalities[i]['constant_name']}</span>`);
					}
				} else {
					$('#opportunity-nationalities').append(`<span class="badge badge-pill badge-light font-weight-normal">All Nationalities</span>`);
				}

				$('#opportunity-study-levels').empty();
				var study_levels = data['data']['getOpportunity']['study_levels'];
				if(study_levels.length > 0) {
					for(var i = 0; i < study_levels.length; i++) {
						$('#opportunity-study-levels').append(`<span class="badge badge-pill badge-light font-weight-normal">${study_levels[i]['name']}</span>`);
					}
				} else {
					$('#opportunity-study-levels').append(`<span class="badge badge-pill badge-light font-weight-normal">All Study Levels</span>`);
				}

				$('#opportunity-logistical-details').empty();
				var logistics_info = data['data']['getOpportunity']['logistics_info'];

				if(logistics_info['accommodation_provided'].indexOf('not') == -1) {
					if(logistics_info['accommodation_covered'].indexOf('not') == -1) {
						$('#opportunity-logistical-details').append(`<p><b>Accommodation: </b>Provided and Covered</p>`);
					} else {
						$('#opportunity-logistical-details').append(`<p><b>Accommodation: </b>Provided but not Covered</p>`);
					}
				} else {
					$('#opportunity-logistical-details').append(`<p><b>Accommodation: </b>Not Provided</p>`);
				}
				if(logistics_info['food_provided'].indexOf('not') == -1) {
					if(logistics_info['food_covered'].indexOf('not') == -1) {
						$('#opportunity-logistical-details').append(`<p><b>Food: </b>Provided and Covered</p>`);
					} else {
						$('#opportunity-logistical-details').append(`<p><b>Food: </b>Provided but not Covered</p>`);
					}
				} else {
					$('#opportunity-logistical-details').append(`<p><b>Food: </b>Not Provided</p>`);
				}
				if(logistics_info['transportation_provided'].indexOf('not') == -1) {
					if(logistics_info['transportation_covered'].indexOf('not') == -1) {
						$('#opportunity-logistical-details').append(`<p><b>Transportation: </b>Provided and Covered</p>`);
					} else {
						$('#opportunity-logistical-details').append(`<p><b>Transportation: </b>Provided but not Covered</p>`);
					}
				} else {
					$('#opportunity-logistical-details').append(`<p><b>Transportation: </b>Not Provided</p>`);
				}
				if(logistics_info['computer_provided'].indexOf('not') == -1) {
					$('#opportunity-logistical-details').append(`<p><b>Computer: </b>Provided</p>`);
				} else {
					$('#opportunity-logistical-details').append(`<p><b>Computer: </b>Not Provided</p>`);
				}

				opportunity_cost = 
				$('#opportunity-fees').html(`${data['data']['getOpportunity']['opportunity_cost']['currency']} ${data['data']['getOpportunity']['opportunity_cost']['total'].toFixed(2)}`)
				
				$('#opportunity-select-slot').html(`<option value="" disabled selected>Select a slot</option>`);
				var available_slots = data['data']['getOpportunity']['available_slots'];
				for(var i = 0; i < available_slots.length; i++) {
					$('#opportunity-select-slot').append(`<option value="${available_slots[i]['id']}">From ${available_slots[i]['start_date']} to ${available_slots[i]['end_date']}</option>`);
				}
            }
            
            function fetch_opportunity_details() {
                var opportunity_id = get_opportunity_id();
                var query = `query {
                    getOpportunity(id : ${opportunity_id}) { 
						title
                        organisation {
							name
							summary
						}
						location
						description
						work_hours
						role_info {
							learning_points_list
						}
						available_slots {
							id
							start_date
							end_date
						}
						backgrounds {
							constant_name
						}
						skills {
							constant_name
						}
						languages {
							constant_name
						}
						nationalities {
							constant_name
						}
						study_levels {
							name
						}
						logistics_info {
							accommodation_covered
							accommodation_provided
							food_covered
							food_provided
							transportation_covered
							transportation_provided
							computer_provided
						}
						opportunity_cost 
						cover_photo 
                    }
                }`;
                

                data_ = fetch('https://gis-api.aiesec.org/graphql?access_token=67803c4f6086283ff8728ba6da9ada440251ac588a0d05de32ffc2b03eb93d99', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                  },
                  body: JSON.stringify({
                    query,
                  })
                })
                  .then(r => r.json())
				  .then(data => render_opportunity(data))
				  .then(() => {
					  stop_spinner();
				  });
            }

			/* Spinner Action Starts */

			function start_spinner() {
				$('.spinner-container').removeClass('do-not-display');
				$('.content-container').addClass('do-not-display');
			}

			function stop_spinner() {
				$('.spinner-container').addClass('do-not-display');
				$('.content-container').removeClass('do-not-display');
			}
			
			/* Spinner Action Ends */
			
			
			function share(platform){
				var root_url = '';
				switch (platform) {
					case 'facebook':
						root_url = 'https://www.facebook.com/sharer/sharer.php?u=';
						break;
					case 'twitter':
						root_url = 'https://twitter.com/home?status=';
						break;
					case 'linkedin':
						root_url = 'https://www.linkedin.com/shareArticle?mini=true&url=';
						break;
					default:
						break;
				}
				window.open(`${root_url}${document.location.href}`);
			}

            function main() {
                fetch_opportunity_details();
            }

            window.onload = main;


        </script>
    </body>
</html>